desc: Particle probability
source: AIME I 2019/5
tags: [2019-10, answer, cmedium, combo, dp]

---

A moving particle starts at the point $(4,4)$ and moves until it hits one of the coordinate axes for the first time. When the particle is at the point $(a,b)$, it moves at random to one of the points $(a-1,b)$, $(a,b-1)$, or $(a-1,b-1)$, each with probability $\tfrac 13$, independently of its previous moves. The probability that it will hit the coordinate axes at $(0,0)$ is $\tfrac{m}{3^n}$, where $m$ and $n$ are positive integers, and $m$ is not divisible by $3$. Find $m+n$.

---

Let $\mathbb P(a,b)$ be the probability the ant reaches $(a,b)$. Then, for all $t\ge 1$, $\mathbb P(t,4)=\mathbb P(4,t)=1/3^{4-t}$ and for all $a,b\ge 1$, \[\mathbb{P}(a,b)=\frac{\mathbb{P}(a-1,b)+\mathbb{P}(a,b-1)+\mathbb{P}(a,b)}3.\]
We can now proceed with dynamic programming:
\begin{center}
    \begin{asy}
        size(5cm);
        dot((4-1, 4-1));
        label("$\displaystyle1$", (4-1, 4-1-0.2), SE);
        dot("$\displaystyle\frac{1}{3}$", (4-2, 4-1), SE);
        dot("$\displaystyle\frac{1}{9}$", (4-3, 4-1), SE);
        dot("$\displaystyle\frac{1}{27}$", (4-4, 4-1), SE);
        dot("$\displaystyle\frac{1}{3}$", (4-1, 4-2), SE);
        dot("$\displaystyle\frac{5}{9}$", (4-2, 4-2), SE);
        dot("$\displaystyle\frac{1}{3}$", (4-3, 4-2), SE);
        dot("$\displaystyle\frac{13}{81}$", (4-4, 4-2), SE);
        dot("$\displaystyle\frac{1}{9}$", (4-1, 4-3), SE);
        dot("$\displaystyle\frac{1}{3}$", (4-2, 4-3), SE);
        dot("$\displaystyle\frac{11}{27}$", (4-3, 4-3), SE);
        dot("$\displaystyle\frac{73}{243}$", (4-4, 4-3), SE);
        dot("$\displaystyle\frac{1}{27}$", (4-1, 4-4), SE);
        dot("$\displaystyle\frac{13}{81}$", (4-2, 4-4), SE);
        dot("$\displaystyle\frac{73}{243}$", (4-3, 4-4), SE);
        dot("$\displaystyle\frac{245}{729}$", (4-4, 4-4), SE);
    \end{asy}
\end{center}
Since the ant must come from $(1,1)$ to reach $(0,0)$, the answer is \[\mathbb P(0,0)=\frac13\mathbb P(1,1)=\frac{245}{3^7},\]
and the requested sum is $245+7=252$.

---

252
