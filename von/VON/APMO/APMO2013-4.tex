desc: Either i+a in A or i-b in B
source: APMO 2013/4
tags: [2020-04, oly, medium, combo, arrows, nice]

---

Let $a$ and $b$ be positive integers, and let $A$ and $B$ be finite disjoint sets of positive integers. Assume that for every $i\in A\cup B$, we have $i+a\in A$ or $i-b\in B$. Prove that $a|A|=b|B|$.

---

We present three solutions that are actually isomorphic. Nonetheless they present different ways to think of the solution.

\paragraph{First solution, by arrows} Consider the directed graph between elements of $A\cup B$, where $i$ points to $j$ if $j=i+a\in A$ or $j=i-b\in B$. Hence each vertex has outdegree at least $1$. I contend each vertex has indegree exactly $1$. Indeed, if $i\in A$, any incoming edge has other endpoint $i-a$, and if $i\in B$, any incoming edge has other endpoint $i+b$.

It follows that each vertex has outdegree and indegree exactly $1$, so the graph is comprised of disjoint cycle. Consider any one of these cycles, and say it contains $p$ elements in $A$ and $q$ elements in $B$. I claim $ap=bq$, and summing will give the desired result.

Let $x$ be any vertex of the cycle. There are $p$ edges of the form $i\to i+a$ and $q$ edges of the form $i\to i-b$. After traversing all the edges of the cycle in some order, we will end up where we started, at $x=x+ap-bq$. Hence $ap=bq$, and we are done.

\paragraph{Second solution, by Inclusion-Exclusion} We begin with the following claim:
\begin{claim*}
    $A\cup B=(A-a)\cup(B+b)$, and $A-a$, $B+b$ are disjoint.
\end{claim*}
\begin{proof}
    We know for each $i\in A$, we have $i-a\in A\cup B$, and for each $i\in B$, we have $i+b\in A\cup B$. Hence $A\cup B\subseteq(A-a)\cup(B+b)$. It then follows that \[|A\cup B|\le|(A-a)\cup(B+b)|\le|A-a|+|B+b|=|A|+|B|=|A\cup B|,\]
    so equality holds, and the claim follows.
\end{proof}

Let $\sum S$ denote the sum of the elements of $S$. Summing over the elements of $A\cup B=(A-a)\cup(B+b)$, we have \[\sum A+\sum B=\sum(A-a)+\sum(B+b)=\left(\sum A+\sum B\right)-a|A|+b|B|,\]
whence $a|A|=b|B|$, as needed.

\paragraph{Third solution, by generating functions} Let $A(x)=\sum_{i\in A}x^i$ and $B(x)=\sum_{i\in B}x^i$ be the generating functions for $A$, $B$. Apply the claim in the above solution, so $A\cup B=(A-a)\cup(B+b)$. It follows that $A(x)+B(x)=x^{-a}A(x)+x^bB(x)$. This rewrites as \[\frac{A(x)}{x^a}\cdot\frac{x^a-1}{x-1}=B(x)\cdot\frac{x^b-1}{x-1}.\]
Plugging in $x=1$ yields the desired conclusion. (Alternatively differentiate at $x=1$.)
