desc: (g(m)+n)(g(n)+m) square
source: IMO 2010/3
tags: [2020-04, oly, tricky, nt, fe, nice, waltz]

---

Find all functions $g:\mathbb N\to\mathbb N$ such that \[(g(m)+n)(g(n)+m)\]
is a perfect square for all $m,n\in\mathbb N$.

---

The answer is $g(n)\equiv n+c$, which works. The key claim:
\begin{claim*}
    For $p$ prime, if $p\mid g(a)-g(b)$, then $p\mid a-b$.
\end{claim*}
\begin{proof}
    Take $m$ such that $\nu_p(m+g(a))$ and $\nu_p(m+g(b))$ are odd:
    \begin{itemize}[itemsep=0em]
        \item if $p^2\mid g(b)-g(a)$, then take $m\equiv p-g(a)\pmod{p^2}$.
        \item if $p^2\nmid g(b)-g(a)$, then take $m\equiv -g(b)\pmod{p^3}$.
    \end{itemize}
    Then $\nu_p( (g(m)+a)(m+g(a)))$ is even, so $p\mid g(m)+a$; analogously $p\mid g(m)+b$. Hence $p\mid a-b$, as claimed.
\end{proof}

Taking $a=n+1$ and $b=n$ in the above claim, we have $g(n+1)=g(n)\pm1$. But note that \[(g(n)+n)^2<(g(n)+n)(g(n)+n+2)<(g(n)+n+1)^2,\]
so $g(n)\ne g(n+2)$ for all $n$. It follows that if $g(n+1)=g(n)-1$ for some $n$, then $g(n+2)=g(n+1)-1$, hence $g$ is forever strictly decreasing, which is absurd.

Thus $g(n+1)=g(n)+1$, and we are done.
