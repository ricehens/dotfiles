desc: Linear recurrence with fixed residue mod p
source: InfinityDots 2018/5
tags: [2020-02, oly, medium, nt, int-poly]

---

Let $c_1$, $\ldots$, $c_k$ be integers. Consider sequences $(a_n)$ of integers satisfying the recurrence \[a_n=c_1a_{n-1}+c_2a_{n-2}+\cdots+c_ka_{n-k}\]
for all $n>k$. Prove that there is a choice of initial terms $a_1$, $\ldots$, $a_k$ and an integer $b$, not all zero, such that $a_p\equiv b\pmod p$ for every prime $p$.

---

Let $P(X)$ be the characteristic polynomial, and let it have roots $\zeta_1$, $\zeta_2$, $\ldots$, $\zeta_k$. Then \[a_n=T_1\zeta_1^n+T_2\zeta_2^n+\cdots+T_k\zeta_k^n.\]
I claim taking $T_1=T_2=\cdots=T_k=T$ and $b=T(\zeta_1+\zeta_2+\cdots+\zeta_k)$ works.

We work over $\mathbb F_{p^j}$ (where $j\le k$), the $\mathbb F_p$-splitting field of $P(X)$. Consider the Frobenius endomorphism $\sigma:\mathbb F_{p^j}\to\mathbb F_{p^j}$ with $\sigma(X)=X^p$.

Note that $\sigma$ fixes $P$, so it permutes its roots. Then \[a_p=T\left(\zeta_1^p+\zeta_2^p+\cdots+\zeta_k^p\right)=T(\zeta_1+\zeta_2+\cdots+\zeta_k)=b,\]
and we are done.
