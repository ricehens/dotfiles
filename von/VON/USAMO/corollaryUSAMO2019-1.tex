desc: f^2(n)f^n(n)=n^2
source: corollary USAMO 2019/1
tags: [2020-04, oly, easy, alg, fe, arrows, mini]

---

Find all functions $f:\mathbb N\to\mathbb N$ satisfying \[\underbrace{f(f(\ldots f}_{n\text{ times}}(n)\ldots))=\frac{n^2}{f(f(n))}\]
for all positive integers $n$.

---

Just like USAMO 2019/1, the answer is $f$ fixes odd and is an involution on the evens. It is not hard to check these work, so now we prove they are the only ones.
\setcounter{claim}0
\begin{claim}
    Let $k\in\mathbb N$ and let $n$ be odd. Then $f(k)=n$ if and only if $k=n$.
\end{claim}
\begin{proof}
    Strong induct on $n$, with no base case.

    Suppose the claim holds for odd integers less than $n$. Consider the equation $f^2(n)f^n(n)=n^2$. It is easy to verify by inductive hypothesis that $f^2(n)\ge n$ and $f^n(n)\ge n$, thus $f^2(n)=f^n(n)=n$. It follows readily that $f(n)=n$ by noting that the sequence $n$, $f(n)$, $f^2(n)$, $\ldots$ repeats with period $2$.

    Finally assume $f(k)=n$. Then $k^2=f^2(k)f^k(k)=n^2$, so $k=n$.
\end{proof}
\begin{claim}
    Let $k\in\mathbb N$ and let $n$ be even. Then $f^2(k)=n$ if and only if $k=n$.
\end{claim}
\begin{proof}
    The proof is similar to that of Claim 1. Strong induct on $n$, with no base case.

    Suppose the claim holds for even integers less than $n$. Consider the equation $f^2(n)f^n(n)=n^2$. It is easy to verify by inductive hypothesis that $f^2(n)\ge n$ and $f^n(n)\ge n$, so $f^2(n)=n$.

    Finally if $f^2(k)=n$, then $k$ is odd by Claim 1. We have $k^2=f^2(k)f^k(k)=n^2$, so $k=n$.
\end{proof}
